<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Clean data — wdpa_clean • wdpar</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Clean data — wdpa_clean"><meta property="og:description" content="Clean data obtained from
Protected Planet.
Specifically, this function is designed to clean data obtained from
the World Database on Protected Areas
(WDPA) and the World Database on Other Effective Area-Based Conservation
Measures (WDOECM).
For recommended practices on cleaning large datasets
(e.g. datasets that span multiple countries or a large geographic area),
please see below."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wdpar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/wdpar.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/prioritizr/wdpar/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Clean data</h1>
    <small class="dont-index">Source: <a href="https://github.com/prioritizr/wdpar/blob/HEAD/R/wdpa_clean.R" class="external-link"><code>R/wdpa_clean.R</code></a></small>
    <div class="hidden name"><code>wdpa_clean.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Clean data obtained from
<a href="https://www.protectedplanet.net/en" class="external-link">Protected Planet</a>.
Specifically, this function is designed to clean data obtained from
the World Database on Protected Areas
(WDPA) and the World Database on Other Effective Area-Based Conservation
Measures (WDOECM).
For recommended practices on cleaning large datasets
(e.g. datasets that span multiple countries or a large geographic area),
please see below.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">wdpa_clean</span><span class="op">(</span>
  <span class="va">x</span>,
  crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=cea +lon_0=0 +lat_ts=30 +x_0=0"</span>,
    <span class="st">"+y_0=0 +datum=WGS84 +ellps=WGS84 +units=m +no_defs"</span><span class="op">)</span>,
  exclude_unesco <span class="op">=</span> <span class="cn">TRUE</span>,
  retain_status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Designated"</span>, <span class="st">"Inscribed"</span>, <span class="st">"Established"</span><span class="op">)</span>,
  snap_tolerance <span class="op">=</span> <span class="fl">1</span>,
  simplify_tolerance <span class="op">=</span> <span class="fl">0</span>,
  geometry_precision <span class="op">=</span> <span class="fl">1500</span>,
  erase_overlaps <span class="op">=</span> <span class="cn">TRUE</span>,
  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf::sf()</a></code> object containing protected area data.</p></dd>
<dt>crs</dt>
<dd><p><code>character</code> or codeinteger object representing a
coordinate reference system. Defaults to World Behrmann
(<em>ESRI:54017</em>).</p></dd>
<dt>exclude_unesco</dt>
<dd><p><code>logical</code> should UNESCO Biosphere Reserves be excluded?
Defaults to <code>TRUE</code>.</p></dd>
<dt>retain_status</dt>
<dd><p><code>character</code> vector containing the statuses for
protected areas that should be retained during the cleaning process.
Available statuses include:
<code>"Proposed"</code>, <code>"Inscribed"</code>, <code>"Adopted"</code>, <code>"Designated"</code>, and
<code>"Established"</code>.
Additionally, a <code>NULL</code> argument can be specified to ensure that no
protected areas are excluded according to their status.
The default argument is a <code>character</code> vector containing <code>"Designated"</code>,
<code>"Inscribed"</code>, and <code>"Established"</code>.
This default argument ensures that protected areas that are not currently
implemented are excluded.</p></dd>
<dt>snap_tolerance</dt>
<dd><p><code>numeric</code> tolerance for snapping geometry to a
grid for resolving invalid geometries. Defaults to 1 meter.</p></dd>
<dt>simplify_tolerance</dt>
<dd><p><code>numeric</code> simplification tolerance.
Defaults to 0 meters.</p></dd>
<dt>geometry_precision</dt>
<dd><p><code>numeric</code> level of precision for processing
the spatial data (used with <code><a href="https://r-spatial.github.io/sf/reference/st_precision.html" class="external-link">sf::st_set_precision()</a></code>). The
default argument is 1500 (higher values indicate higher precision).
This level of precision is generally suitable for analyses at the
national-scale. For analyses at finer-scale resolutions, please
consider using a greater value (e.g. 10000).</p></dd>
<dt>erase_overlaps</dt>
<dd><p><code>logical</code> should overlapping boundaries be
erased? This is useful for making comparisons between individual
protected areas and understanding their "effective" geographic coverage.
On the other hand, this processing step may not be needed
(e.g. if the protected area boundaries are going to be rasterized), and so
processing time can be substantially by skipping this step and setting
the argument to <code>FALSE</code>. Defaults to <code>TRUE</code>.</p></dd>
<dt>verbose</dt>
<dd><p><code>logical</code> should progress on data cleaning be reported?
Defaults to <code>TRUE</code> in an interactive session, otherwise
<code>FALSE</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf::sf()</a></code> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function cleans data following best practices
(Butchart <em>et al.</em> 2015; Protected Planet 2021; Runge <em>et al.</em> 2015).
To obtain accurate protected area coverage statistics for a country,
please note that you will need to manually clip the cleaned data to
the countries' coastline and its Exclusive Economic Zone (EEZ).</p>
<ol><li><p>Repair invalid geometry (using <code><a href="https://r-spatial.github.io/sf/reference/valid.html" class="external-link">sf::st_make_valid()</a></code>).</p></li>
<li><p>Exclude protected areas according to their status (i.e.
<code>"STATUS"</code> field). Specifically, protected areas that have
a status not specified in the argument to <code>retain_status</code> are excluded.
By default, only protected areas that have a
<code>"Designated"</code>, <code>"Inscribed"</code>, or <code>"Established"</code> status are retained.
This means that the default behavior is to exclude protected that
are not currently implemented.</p></li>
<li><p>Exclude United Nations Educational, Scientific and Cultural
Organization (UNESCO) Biosphere Reserves (Coetzer <em>et al.</em> 2014).
This step is only performed if the argument to <code>exclude_unesco</code> is
<code>TRUE</code>.</p></li>
<li><p>Create a field (<code>"GEOMETRY_TYPE"</code>) indicating if areas are
represented as point localities (<code>"POINT"</code>) or as polygons
(<code>"POLYGON"</code>).</p></li>
<li><p>Exclude areas represented as point localities that do not
have a reported spatial extent (i.e. missing data for the field</p></li>
<li><p>Geometries are wrapped to the dateline (using
<code><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">sf::st_wrap_dateline()</a></code> with the options
<code>"WRAPDATELINE=YES"</code> and <code>"DATELINEOFFSET=180"</code>).</p></li>
<li><p>Reproject data to coordinate system specified in argument to
<code>crs</code> (using <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">sf::st_transform()</a></code>).</p></li>
<li><p>Repair any invalid geometries that have manifested
(using <code><a href="st_repair_geometry.html">st_repair_geometry()</a></code>).</p></li>
<li><p>Buffer areas represented as point localities to circular areas
using their reported spatial extent (using data in the field
<code>"REP_AREA"</code> and <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_buffer()</a></code>; see Visconti
<em>et al.</em> 2013).</p></li>
<li><p>Snap the geometries to a grid to fix any remaining
geometry issues (using argument to <code>snap_tolerance</code> and
<code><a href="https://rdrr.io/pkg/lwgeom/man/st_snap_to_grid.html" class="external-link">lwgeom::st_snap_to_grid()</a></code>).</p></li>
<li><p>Repair any invalid geometries that have manifested
(using <code><a href="st_repair_geometry.html">st_repair_geometry()</a></code>).</p></li>
<li><p>Simplify the protected area geometries to reduce computational burden
(using argument to <code>simplify_tolerance</code> and
<code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_simplify()</a></code>).</p></li>
<li><p>Repair any invalid geometries that have manifested
(using <code><a href="st_repair_geometry.html">st_repair_geometry()</a></code>).</p></li>
<li><p>The <code>"MARINE"</code> field is converted from integer codes
to descriptive names (i.e. <code>0</code> = <code>"terrestrial"</code>,
<code>1</code> = <code>"partial"</code>, <code>2</code> = <code>"marine"</code>).</p></li>
<li><p>The <code>"PA_DEF"</code> field is converted from integer codes
to descriptive names (i.e. <code>0</code> = <code>"OECM"</code>, and <code>1</code> = <code>"PA"</code>).</p></li>
<li><p>Zeros in the <code>"STATUS_YR"</code> field are replaced with
missing values (i.e. <code>NA_real_</code> values).</p></li>
<li><p>Zeros in the <code>"NO_TK_AREA"</code> field are replaced with <code>NA</code>
values for areas where such data are not reported or applicable
(i.e. areas with the values <code>"Not Applicable"</code>
or <code>"Not Reported"</code> in the <code>"NO_TK_AREA"</code> field).</p></li>
<li><p>Overlapping geometries are erased from the protected area data
(discussed in Deguignet <em>et al.</em> 2017). Geometries are erased such
that areas associated with more effective management
categories (<code>"IUCN_CAT"</code>) or have historical precedence are retained
(using <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">sf::st_difference()</a></code>).</p></li>
<li><p>Slivers are removed (geometries with areas less than 0.1 square
meters).</p></li>
<li><p>The size of areas are calculated in square kilometers and stored in
the field <code>"AREA_KM2"</code>.</p></li>
</ol></div>
    <div id="recommended-practices-for-large-datasets">
    <h2>Recommended practices for large datasets</h2>
    

<p>This function can be used to clean large datasets assuming that
sufficient computational resources and time are available.
Indeed, it can clean data spanning large countries, multiple
countries, and even the full global datatset.
When processing the full global dataset, it is recommended to use a
computer system with at least 32 GB RAM available and to allow for at least
one full day for the data cleaning procedures to complete.
It is also recommended to avoid using the computer system for any other
tasks while the data cleaning procedures are being completed,
because they are very computationally intensive.
Additionally, when processing large datasets -- and especially
for the global dataset -- it is strongly recommended to disable the
procedure for erasing overlapping areas.
This is because the built-in procedure for erasing overlaps is
very time consuming when processing many protected areas, so that
information on each protected area can be output
(e.g. IUCN category, year established).
Instead, when cleaning large datasets, it is recommended to run
the data cleaning procedures with the procedure for erasing
overlapping areas disabled (i.e. with <code>erase_overlaps = FALSE</code>).
After the data cleaning procedures have completed,
the protected area data can be manually dissolved
to remove overlapping areas (e.g. using <code><a href="wdpa_dissolve.html">wdpa_dissolve()</a></code>).
For an example of processing a large protected area dataset,
please see the vignette.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Butchart SH, Clarke M, Smith RJ, Sykes RE, Scharlemann JP,
Harfoot M, ... &amp; Brooks TM (2015) Shortfalls and solutions for
meeting national and global conservation area targets.
<em>Conservation Letters</em>, <strong>8</strong>: 329--337.</p>
<p>Coetzer KL, Witkowski ET, &amp; Erasmus BF (2014) Reviewing
Biosphere Reserves globally: Effective conservation action or bureaucratic
label? <em>Biological Reviews</em>, <strong>89</strong>: 82--104.</p>
<p>Deguignet M, Arnell A, Juffe-Bignoli D, Shi Y, Bingham H, MacSharry B &amp;
Kingston N (2017) Measuring the extent of overlaps in protected area
designations. <em>PloS One</em>, <strong>12</strong>: e0188681.</p>
<p>Runge CA, Watson JEM, Butchart HM, Hanson JO, Possingham HP &amp; Fuller RA
(2015) Protected areas and global conservation of migratory birds.
<em>Science</em>, <strong>350</strong>: 1255--1258.</p>
<p>Protected Planet (2021) Calculating protected and OECM area coverage.
Available at:
<a href="https://www.protectedplanet.net/en/resources/calculating-protected-area-coverage" class="external-link">https://www.protectedplanet.net/en/resources/calculating-protected-area-coverage</a>.</p>
<p>Visconti P, Di Marco M, Alvarez-Romero JG, Januchowski-Hartley SR, Pressey,
RL, Weeks R &amp; Rondinini C (2013) Effects of errors and gaps in spatial data
sets on assessment of conservation progress. <em>Conservation Biology</em>,
<strong>27</strong>: 1000--1010.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="wdpa_fetch.html">wdpa_fetch()</a></code>, <code><a href="wdpa_dissolve.html">wdpa_dissolve()</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \dontrun{</span></span>
<span class="r-in"><span class="co"># fetch data for the Liechtenstein</span></span>
<span class="r-in"><span class="va">lie_raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="wdpa_fetch.html">wdpa_fetch</a></span><span class="op">(</span><span class="st">"LIE"</span>, wait <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># clean data</span></span>
<span class="r-in"><span class="va">lie_data</span> <span class="op">&lt;-</span> <span class="fu">wdpa_clean</span><span class="op">(</span><span class="va">lie_raw_data</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot cleaned dataset</span></span>
<span class="r-in"><span class="fu"><a href="https://r-spatial.github.io/sf/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lie_data</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>plotting the first 9 out of 32 attributes; use max.plot = 32 to plot all</span>
<span class="r-plt img"><img src="wdpa_clean-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://jeffrey-hanson.com" class="external-link">Jeffrey O Hanson</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

